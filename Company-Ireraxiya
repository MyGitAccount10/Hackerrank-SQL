SELECT D.COMPANY_CODE,D.FOUNDER,SAY_LM,SAY_SM
,SAY_M, SAY_E
FROM (SELECT CM.COMPANY_CODE, FOUNDER,COUNT(DISTINCT LM.LEAD_MANAGER_CODE) [SAY_LM]
FROM COMPANY CM LEFT JOIN LEAD_MANAGER LM WITH (NOLOCK) ON
CM.COMPANY_CODE=LM.COMPANY_CODE 
GROUP BY  CM.COMPANY_CODE, FOUNDER) D INNER JOIN 
(SELECT CM.COMPANY_CODE, FOUNDER,COUNT(DISTINCT SM.SENIOR_MANAGER_CODE) [SAY_SM]
FROM COMPANY CM LEFT JOIN  SENIOR_MANAGER SM WITH (NOLOCK) ON SM.COMPANY_CODE=CM.COMPANY_CODE
GROUP BY  CM.COMPANY_CODE, FOUNDER) F ON D.COMPANY_CODE=F.COMPANY_CODE
INNER JOIN
(SELECT CM.COMPANY_CODE, FOUNDER,COUNT(DISTINCT MANAGER_CODE) [SAY_M]
FROM COMPANY CM LEFT JOIN  MANAGER M WITH (NOLOCK) ON M.COMPANY_CODE=CM.COMPANY_CODE
GROUP BY  CM.COMPANY_CODE, FOUNDER) G 
ON D.COMPANY_CODE=G.COMPANY_CODE
INNER JOIN 
(SELECT CM.COMPANY_CODE, FOUNDER,COUNT(DISTINCT EMPLOYEE_CODE) [SAY_E]
FROM COMPANY CM LEFT JOIN  EMPLOYEE EM WITH (NOLOCK) ON EM.COMPANY_CODE=CM.COMPANY_CODE
GROUP BY  CM.COMPANY_CODE, FOUNDER) NM ON D.COMPANY_CODE=NM.COMPANY_CODE

ORDER BY D.COMPANY_CODE
